@tailwind base;
@tailwind components;
@tailwind utilities;

/*
 * Obsidian Signal Brand System
 *
 * Color Palette:
 * - Obsidian (#0C0C0E): Primary dark surface
 * - Burnished Copper (#C4956A): Accent, decorative (not for text on light)
 * - Copper Text (#7D5A36): Readable copper on light backgrounds
 * - Copper CTA (#8A5C32): Button backgrounds with white text
 * - Bone (#EDE8DF): Light mode surface
 * - Signal White (#F8F6F2): Primary text on dark
 * - Graphite (#2A2A2E): Elevated dark cards
 * - Warm Steel (#8A8578): Borders, dividers (not for text)
 * - Muted Text (#6B6659): Secondary text on light backgrounds
 */

@layer base {
  :root {
    /* Light mode - Bone-based surfaces */
    --background: 40 33% 96%; /* Signal White #F8F6F2 */
    --foreground: 240 8% 4%; /* Obsidian #0C0C0E */

    --card: 0 0% 100%; /* Pure white for cards */
    --card-foreground: 240 8% 4%; /* Obsidian */

    --popover: 0 0% 100%;
    --popover-foreground: 240 8% 4%;

    /* Primary = Copper CTA (accessible for buttons) */
    --primary: 30 47% 37%; /* Copper CTA #8A5C32 */
    --primary-foreground: 40 33% 96%; /* Signal White */

    /* Secondary = Bone tinted */
    --secondary: 39 30% 90%; /* Bone #EDE8DF */
    --secondary-foreground: 240 8% 4%; /* Obsidian */

    /* Muted = Light bone */
    --muted: 39 25% 93%;
    --muted-foreground: 43 9% 38%; /* Muted Text #6B6659 */

    /* Accent = Copper-tinted */
    --accent: 30 41% 92%; /* Light copper tint */
    --accent-foreground: 30 41% 35%; /* Copper Text #7D5A36 */

    --destructive: 4 72% 45%; /* Brand Error #A8433C */
    --destructive-foreground: 40 33% 96%;

    --success: 153 40% 30%; /* Brand Success #2E6B4F */
    --success-foreground: 40 33% 96%;

    --warning: 30 41% 59%; /* Burnished Copper as warning */
    --warning-foreground: 240 8% 4%;

    --border: 39 20% 88%;
    --input: 39 20% 88%;
    --ring: 30 47% 37%; /* Copper CTA */
    --radius: 0.5rem;

    /* Brand-specific tokens */
    --copper: 30 41% 59%; /* Burnished Copper #C4956A */
    --copper-text: 30 41% 35%; /* Copper Text #7D5A36 */
    --obsidian: 240 8% 4%; /* Obsidian #0C0C0E */
    --bone: 39 30% 90%; /* Bone #EDE8DF */
    --steel: 43 9% 51%; /* Warm Steel #8A8578 */
  }

  .dark {
    /* Dark mode - Obsidian-based surfaces */
    --background: 240 8% 4%; /* Obsidian #0C0C0E */
    --foreground: 40 33% 96%; /* Signal White #F8F6F2 */

    --card: 240 7% 17%; /* Graphite #2A2A2E */
    --card-foreground: 40 33% 96%;

    --popover: 240 7% 17%;
    --popover-foreground: 40 33% 96%;

    /* Primary = Burnished Copper (AAA on dark) */
    --primary: 30 41% 59%; /* Burnished Copper #C4956A */
    --primary-foreground: 240 8% 4%; /* Obsidian */

    /* Secondary = Graphite */
    --secondary: 240 7% 17%; /* Graphite */
    --secondary-foreground: 40 33% 96%;

    /* Muted = Dark graphite */
    --muted: 240 7% 14%;
    --muted-foreground: 43 9% 51%; /* Warm Steel */

    /* Accent = Copper-tinted dark */
    --accent: 30 30% 15%;
    --accent-foreground: 30 41% 59%; /* Burnished Copper */

    --destructive: 4 62% 35%;
    --destructive-foreground: 40 33% 96%;

    --success: 153 50% 40%;
    --success-foreground: 240 8% 4%;

    --warning: 30 50% 50%;
    --warning-foreground: 240 8% 4%;

    --border: 240 7% 22%;
    --input: 240 7% 22%;
    --ring: 30 41% 59%; /* Burnished Copper */

    /* Brand-specific tokens (same in dark mode) */
    --copper: 30 41% 59%;
    --copper-text: 30 41% 59%; /* Can use full copper on dark */
    --obsidian: 240 8% 4%;
    --bone: 39 30% 90%;
    --steel: 43 9% 51%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-family: var(--font-sans-brand), var(--font-inter), system-ui, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Use Shippori Mincho B1 for all headings */
  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-serif), Georgia, serif;
  }

  /* Utility class for heading font */
  .font-heading {
    font-family: var(--font-serif), Georgia, serif;
  }

  /* Use mono font for code elements */
  code, pre, kbd, samp {
    font-family: var(--font-mono), monospace;
  }
}

/* Custom scrollbar with brand colors */
@layer utilities {
  .scrollbar-thin {
    scrollbar-width: thin;
  }

  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .scrollbar-thin::-webkit-scrollbar-track {
    @apply bg-muted rounded-full;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground/30 rounded-full hover:bg-muted-foreground/50;
  }
}

/* Focus visible styles for accessibility */
@layer base {
  :focus-visible {
    @apply outline-none ring-2 ring-ring ring-offset-2 ring-offset-background;
  }
}

/* Skip link for accessibility */
.skip-link {
  @apply absolute -top-10 left-0 bg-primary text-primary-foreground px-4 py-2 z-50 transition-all focus:top-0;
}

/* Brand utility classes */
@layer utilities {
  .text-copper {
    color: hsl(var(--copper-text));
  }

  .bg-copper {
    background-color: hsl(var(--copper));
  }

  .border-copper {
    border-color: hsl(var(--copper));
  }

  .text-bone {
    color: hsl(var(--bone));
  }

  .bg-bone {
    background-color: hsl(var(--bone));
  }

  .text-obsidian {
    color: hsl(var(--obsidian));
  }

  .bg-obsidian {
    background-color: hsl(var(--obsidian));
  }
}

/* TipTap Editor Styles */
@layer components {
  /* Editor prose styles */
  .ProseMirror {
    @apply outline-none;
  }

  .ProseMirror p {
    @apply my-1;
  }

  .ProseMirror p:first-child {
    @apply mt-0;
  }

  .ProseMirror p:last-child {
    @apply mb-0;
  }

  .ProseMirror ul,
  .ProseMirror ol {
    @apply my-2;
  }

  .ProseMirror li {
    @apply my-0.5;
  }

  .ProseMirror a {
    @apply text-primary underline underline-offset-2 cursor-pointer hover:text-primary/80;
  }

  /* Mention styles */
  .ProseMirror .mention {
    @apply bg-primary/10 text-primary rounded px-1 py-0.5 font-medium;
  }

  /* Placeholder styles */
  .ProseMirror p.is-editor-empty:first-child::before {
    @apply text-muted-foreground pointer-events-none float-left h-0;
    content: attr(data-placeholder);
  }
}

/* Tippy.js popup styles for mention suggestions */
.tippy-box[data-theme~='light-border'] {
  @apply bg-popover text-popover-foreground border border-border rounded-md shadow-md;
}

.tippy-box[data-theme~='light-border'] .tippy-content {
  @apply p-0;
}

.tippy-box[data-theme~='light-border'] .tippy-arrow::before {
  @apply border-b-border;
}
